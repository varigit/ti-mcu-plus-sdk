<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM62x MCU+ SDK: Accessing main and wakeup domain peripherals from MCU domain</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM62x MCU+ SDK
   &#160;<span id="projectnumber">08.06.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('MAIN_DOMAIN_PERIPHERAL_FROM_MCU.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Accessing main and wakeup domain peripherals from MCU domain </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md175">Introduction</a></li>
<li class="level1"><a href="#autotoc_md176">Summary of steps needed to access main/wakeup domain peripheral</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_developer_guides_main_domain_peripheral_access"></a></p>
<h1><a class="anchor" id="autotoc_md175"></a>
Introduction</h1>
<p>The driver examples (GPIO, I2C, SPI and UART) for MCU-M4 provided as part of this SDK by default uses the instances from the MCU domain. However the examples can be modified to use main/wakeup domain peripheral from the MCU domain.</p>
<dl class="section attention"><dt>Attention</dt><dd><ul>
<li>Only the polling mode is supported for main/wakeup domain peripheral in MCU-M4 as the interrupts from these instances are not routed to MCU-M4.</li>
<li>As most of the main domain peripheral instances are being used by Linux running on A53, the dts file to be updated to remove the peripheral so that it can be accessed by MCU-M4.</li>
<li>Base address of main or wakeup domain peripheral can be access only via RAT. Ensure that a RAT entry is available for accessing the peripheral's base address region.</li>
</ul>
</dd></dl>
<p>The following main domain peripherals can be access from the MCU domain.</p><ul>
<li>GPIO</li>
<li>I2C</li>
<li>SPI</li>
<li>UART</li>
</ul>
<p>The following wakeup domain peripherals can be access from the MCU domain.</p><ul>
<li>I2C</li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>Wakeup domain UART is being used by DM firmware running on DM R5.</dd></dl>
<h1><a class="anchor" id="autotoc_md176"></a>
Summary of steps needed to access main/wakeup domain peripheral</h1>
<ul>
<li><b>Step 1</b>: Update the dts file to remove the peripheral instance which is required to be accessed by MCU-M4. Build a new linux image with that.</li>
<li><b>Step 2</b>: Open the sysconfig file of the example you want to modify to access main/wakeup domain peripheral.<ul>
<li>For windows users <div class="fragment"><div class="line">gmake -C examples/drivers/{peripheral}/{example}/{board}/m4fss0-0_nortos/ti-arm-clang syscfg-gui</div>
</div><!-- fragment --></li>
<li>For Linux users <div class="fragment"><div class="line">make -C examples/drivers/{peripheral}/{example}/{board}/m4fss0-0_nortos/ti-arm-clang syscfg-gui</div>
</div><!-- fragment --></li>
</ul>
</li>
<li><b>Step 3</b>: Select the wakeup/main domain instance in the configuration.<ul>
<li>For main domain<ul>
<li>Select peripheral from the left side panel</li>
<li>Uncheck <b>Enable Interrupt</b></li>
<li>Uncheck <b>Use MCU Domain Peripherals</b></li>
<li>Select the peripheral instance from the list.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="main_domain_peripheral_access_1.png"]{width:40%}</style> </p><div class="image">
<img src="main_domain_peripheral_access_1.png" alt=""/>
<div class="caption">
Configuring to access main domain peripheral</div></div>
<ul>
<li>For Wakeup domain<ul>
<li>Select peripheral from the left side panel</li>
<li>Uncheck <b>Enable Interrupt</b></li>
<li>Uncheck <b>Use MCU Domain Peripherals</b></li>
<li>Check <b>Use Wakeup Domain Peripherals</b></li>
<li>Select the peripheral instance from the list.</li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="main_domain_peripheral_access_2.png"]{width:40%}</style> </p><div class="image">
<img src="main_domain_peripheral_access_2.png" alt=""/>
<div class="caption">
Configuring to access wakeup domain peripheral</div></div>
<ul>
<li><b>Step 4</b>: Ensure the base address of the peripheral instance is covered in one of the RAT entry.<ul>
<li>For example if I2C1 from the main domain to be accessed from MCU domain, we need to confirm the I2C1 config registers (Base:0x20010000, Size:0x100) are covered by a RAT entry.</li>
<li>The following RAT entry covers the region from 0x20000000 to 0x3FFFFFFF (512MB). So it covers the I2C1 as well. For more information on RAT refer <a class="el" href="KERNEL_DPL_ADDR_TRANSLATE_PAGE.html">Region based Address Translate</a>.</li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="main_domain_peripheral_access_3.png"]{width:40%}</style> </p><div class="image">
<img src="main_domain_peripheral_access_3.png" alt=""/>
<div class="caption">
Configuring to access wakeup domain peripheral</div></div>
<ul>
<li><b>Step 5</b>: Save the sysconfig file and build and run the application. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
