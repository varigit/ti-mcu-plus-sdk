<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM62x MCU+ SDK: ESM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM62x MCU+ SDK
   &#160;<span id="projectnumber">08.06.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('SDL_ESM_PAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ESM </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md481">Features Supported</a></li>
<li class="level1"><a href="#autotoc_md482">SysConfig Features</a></li>
<li class="level1"><a href="#autotoc_md483">Features NOT Supported</a></li>
<li class="level1"><a href="#autotoc_md484">Important Usage Guidelines</a></li>
<li class="level1"><a href="#autotoc_md485">Example Usage</a></li>
<li class="level1"><a href="#autotoc_md486">API</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_components_sdl_esm"></a></p>
<p>The Error Signaling Module (ESM) aggregates safety-related events and/or errors resulting from diagnostics from throughout the device into one location that can be monitored internally or externally. It allows designation of events as high priority or low priority interrupts, and also directly manipulate an I/O error pin to signal an external hardware (e.g. external monitor) that an error has occurred. Using the Error Signaling Module allows a single place in the SoC to manage these events, take corrective action, and clear error pin signaling external hardware if appropriate corrective action is taken. An external controller can monitor the error pin and is able to reset the device or keep the system in a safe, known state.</p>
<p>There can be multiple ESM instances on a device, and each one can support multiple error events that come from the various IP blocks in the device. Detailed information regarding the error events supported can be found in the device-specific TRM.</p>
<p>SDL provides the application with an interface to the ESM. Using SDL ESM, the application can initialize the ESM and listen for the desired error events from the device as well as configure the priority and error pin signaling of the events. As part of initialization of the ESM by the application, the application registers a callback for being notified of the error events. This is called by the SDL's ESM Handler. SDL provides APIs for initializing and configuring the ESM for detecting the HW errors. The application can use the APIs to configure the ESM interrupts and priorities. Also, configuration of the error pin reporting is supported. SDL also provides the ability for the application to manipulate the error pin.</p>
<h1><a class="anchor" id="autotoc_md481"></a>
Features Supported</h1>
<p>The SDL provides support for the ESM through:</p>
<ul>
<li>ESM Configuration API</li>
<li>ESM Handler for error handling and notification</li>
<li>ESM nError Pin manipulation API</li>
<li>ESM static register/written config readback APIs</li>
</ul>
<p>The following can be configured in ESM per instance for each supported event:</p>
<ul>
<li>Enable of interrupt for the event</li>
<li>Interrupt priority for the event</li>
<li>Enable nErrorPin assertion for the event</li>
</ul>
<p>The ESM Handler is responsible for handling the errors at runtime and notifying the application via registered callback. The registered callback will run in interrupt context.</p>
<h1><a class="anchor" id="autotoc_md482"></a>
SysConfig Features</h1>
<ul>
<li>None</li>
</ul>
<h1><a class="anchor" id="autotoc_md483"></a>
Features NOT Supported</h1>
<ul>
<li>None</li>
</ul>
<h1><a class="anchor" id="autotoc_md484"></a>
Important Usage Guidelines</h1>
<ul>
<li>None</li>
</ul>
<h1><a class="anchor" id="autotoc_md485"></a>
Example Usage</h1>
<p>The following shows an example of SDL ESM API usage by the application to set up the ESM to monitor for specific safety events.</p>
<p>In this example, the application configures the ESM for a particular ESM Instance. If there are multiple ESM instances on a device, then all instances for which the application wishes to listen for error events need to be configured. In this example we will configure only one of the ESM Instances</p>
<p>First, we need to decide which event(s) we want to enable, at what priority, and what error pin behavior is desired. To do this, we can reference the |__PART_SOC_TRM__| to find the ESM error events for each ESM instance. In this example, let's say that we have reviewed the TRM, and we have decided that we want to</p>
<ul>
<li>monitor ESM events 10, 11, and 16 for a particular instance</li>
<li>configure event 10 and 11 to be of High priority and to signal on the error pin</li>
<li>configure event 16 to be Low priority and not to signal on the error pin</li>
</ul>
<p>Include the below file to access the APIs</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sdl__esm_8h.html">sdl/sdl_esm.h</a>&gt;</span></div>
</div><!-- fragment --><p>We will set up our ESM config like this:</p>
<div class="fragment"><div class="line"><a class="code" href="structSDL__ESM__config.html">SDL_ESM_config</a> esmInitConfig =</div>
<div class="line">{</div>
<div class="line">    .<a class="code" href="structSDL__ESM__config.html#ad175456d8f1499780ab48da182d68412">esmErrorConfig</a> = {0u, 8u}, <span class="comment">/* Self test error config - error event to use for self test */</span></div>
<div class="line">    .enableBitmap = {0x00010c00u, 0x00000000u, 0x00000000u},</div>
<div class="line">    .priorityBitmap = {0x00000c00u, 0x00000000u, 0x00000000u},</div>
<div class="line">    .errorpinBitmap = {0x00000c00u, 0x00000000u, 0x00000000u},</div>
<div class="line">};</div>
</div><!-- fragment --><p>Additionally, application should define the callback function through which it will receive ESM notifications, for example:</p>
<div class="fragment"><div class="line">int32_t SDL_ESM_applicationCallbackFunction(<a class="code" href="sdl__esm__soc_8h.html#ae5a25ad63d3b6fb92538167520983d51">SDL_ESM_Inst</a> esmInst,</div>
<div class="line">                                            <a class="code" href="group__SDL__ESM__MODULE.html#ga802ac10e6ee170ca234dc37fa5a544bd">SDL_ESM_IntType</a> esmIntrType,</div>
<div class="line">                                            uint32_t grpChannel,</div>
<div class="line">                                            uint32_t <a class="code" href="tisci__rm__proxy_8h.html#a852b86a2eaee9852ada7a43e61e311a2">index</a>,</div>
<div class="line">                                            uint32_t intSrc,</div>
<div class="line">                                            <span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    int32_t retVal = SDL_PASS;</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#gafe348ab5badd2c15118f95e21bb192c6">DebugP_log</a>(<span class="stringliteral">&quot;\n  ESM Call back function called : instType 0x%x, intType 0x%x, &quot;</span> \</div>
<div class="line">                <span class="stringliteral">&quot;grpChannel 0x%x, index 0x%x, intSrc 0x%x \n&quot;</span>,</div>
<div class="line">                esmInst, esmIntrType, grpChannel, <a class="code" href="tisci__rm__proxy_8h.html#a852b86a2eaee9852ada7a43e61e311a2">index</a>, intSrc);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#gafe348ab5badd2c15118f95e21bb192c6">DebugP_log</a>(<span class="stringliteral">&quot;  Take action \n&quot;</span>);</div>
<div class="line">    <span class="comment">/* Any additional application specific actions can be added here */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> retVal;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Now we can call the SDL_ESM_init API:</p>
<div class="fragment"><div class="line">\cond SOC_AM64X</div>
<div class="line">SDL_ESM_InstType instance = MCU_ESM0;</div>
<div class="line">\endcond</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">\cond SOC_AM62X  || SOC_AM62AX</div>
<div class="line">SDL_ESM_InstType instance = WKUP_ESM0;</div>
<div class="line">\endcond</div>
<div class="line">        ret = <a class="code" href="group__SDL__ESM__MODULE.html#ga9ce49362624d8bbb550a5a78198dff67">SDL_ESM_init</a>(instance, &amp;esmInitConfig, SDL_ESM_applicationCallbackFunction,ptr);</div>
<div class="line">        <span class="keywordflow">if</span> (ret != SDL_PASS)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// handle error</span></div>
<div class="line">        }</div>
</div><!-- fragment --><p>When error events occur, the Application's registered callback will be invoked and the application can take action as needed.</p>
<p>If an error pin is asserted due to an error event, the application can additionally decide to clear the error pin:</p>
<div class="fragment"><div class="line"><a class="code" href="group__SDL__ESM__MODULE.html#ga9e180bb2d7cc584f3bd10ce49d7ec99a">SDL_ESM_clrNError</a>(instance);</div>
</div><!-- fragment --><p>Note that the pin will remain active for the minimum time interval even after being cleared. Once the minimum time interval expires, the clear will take affect.</p>
<p>The application can also force the error pin active:</p>
<div class="fragment"><div class="line"><a class="code" href="group__SDL__ESM__MODULE.html#ga9db3167e35cc52ad44eda6520664a36f">SDL_ESM_setNError</a>(instance);</div>
</div><!-- fragment --><p>The SDL ESM also provides APIs to assist in implementing diagnostics related to static config register readback and readback of written config. In order to verify the written config, after calling SDL_ESM_init, SDL_ESM_verifyConfig may be called:</p>
<div class="fragment"><div class="line">ret = <a class="code" href="group__SDL__ESM__MODULE.html#gad1bf99d8a66ec79494c85e534621176f">SDL_ESM_verifyConfig</a>(instance, esmInitConfig);</div>
<div class="line"><span class="keywordflow">if</span> (ret != SDL_PASS)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// verification failed</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>In order to readback the static config:</p>
<div class="fragment"><div class="line">ret = <a class="code" href="group__SDL__ESM__MODULE.html#gaa6038c780ee7ecdef27dcc9abe883712">SDL_ESM_getStaticRegisters</a>(instance, &amp;staticRegs);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md486"></a>
API</h1>
<p><a class="el" href="group__SDL__ESM__MODULE.html">APIs for SDL ESM</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="agroup__SDL__ESM__MODULE_html_ga802ac10e6ee170ca234dc37fa5a544bd"><div class="ttname"><a href="group__SDL__ESM__MODULE.html#ga802ac10e6ee170ca234dc37fa5a544bd">SDL_ESM_IntType</a></div><div class="ttdeci">SDL_ESM_IntType</div><div class="ttdef"><b>Definition:</b> esm/sdl_esm.h:104</div></div>
<div class="ttc" id="asdl__esm__soc_8h_html_ae5a25ad63d3b6fb92538167520983d51"><div class="ttname"><a href="sdl__esm__soc_8h.html#ae5a25ad63d3b6fb92538167520983d51">SDL_ESM_Inst</a></div><div class="ttdeci">SDL_ESM_Inst</div><div class="ttdef"><b>Definition:</b> sdl_esm_soc.h:59</div></div>
<div class="ttc" id="asdl__esm_8h_html"><div class="ttname"><a href="sdl__esm_8h.html">sdl_esm.h</a></div><div class="ttdoc">This file contains the SDL ESM API's.</div></div>
<div class="ttc" id="astructSDL__ESM__config_html"><div class="ttname"><a href="structSDL__ESM__config.html">SDL_ESM_config</a></div><div class="ttdoc">ESM init configuration.</div><div class="ttdef"><b>Definition:</b> esm/sdl_esm.h:198</div></div>
<div class="ttc" id="atisci__rm__proxy_8h_html_a852b86a2eaee9852ada7a43e61e311a2"><div class="ttname"><a href="tisci__rm__proxy_8h.html#a852b86a2eaee9852ada7a43e61e311a2">index</a></div><div class="ttdeci">uint16_t index</div><div class="ttdef"><b>Definition:</b> tisci_rm_proxy.h:3</div></div>
<div class="ttc" id="agroup__SDL__ESM__MODULE_html_ga9e180bb2d7cc584f3bd10ce49d7ec99a"><div class="ttname"><a href="group__SDL__ESM__MODULE.html#ga9e180bb2d7cc584f3bd10ce49d7ec99a">SDL_ESM_clrNError</a></div><div class="ttdeci">int32_t SDL_ESM_clrNError(SDL_ESM_Inst instance)</div><div class="ttdoc">SDL ESM API to clear the nError pin for the specified ESM instance.</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__DEBUG_html_gafe348ab5badd2c15118f95e21bb192c6"><div class="ttname"><a href="group__KERNEL__DPL__DEBUG.html#gafe348ab5badd2c15118f95e21bb192c6">DebugP_log</a></div><div class="ttdeci">#define DebugP_log(format,...)</div><div class="ttdoc">Function to log a string to the enabled console.</div><div class="ttdef"><b>Definition:</b> DebugP.h:211</div></div>
<div class="ttc" id="agroup__SDL__ESM__MODULE_html_gaa6038c780ee7ecdef27dcc9abe883712"><div class="ttname"><a href="group__SDL__ESM__MODULE.html#gaa6038c780ee7ecdef27dcc9abe883712">SDL_ESM_getStaticRegisters</a></div><div class="ttdeci">int32_t SDL_ESM_getStaticRegisters(SDL_ESM_Inst instance, SDL_ESM_staticRegs *pStaticRegs)</div><div class="ttdoc">SDL ESM API to read the static registers. The API reads and returns the static register configuration...</div></div>
<div class="ttc" id="agroup__SDL__ESM__MODULE_html_gad1bf99d8a66ec79494c85e534621176f"><div class="ttname"><a href="group__SDL__ESM__MODULE.html#gad1bf99d8a66ec79494c85e534621176f">SDL_ESM_verifyConfig</a></div><div class="ttdeci">int32_t SDL_ESM_verifyConfig(SDL_ESM_Inst instance, const SDL_ESM_config *pConfig)</div><div class="ttdoc">SDL ESM API to verify the written configuration of the ESM module. The API verifies the written confi...</div></div>
<div class="ttc" id="agroup__SDL__ESM__MODULE_html_ga9db3167e35cc52ad44eda6520664a36f"><div class="ttname"><a href="group__SDL__ESM__MODULE.html#ga9db3167e35cc52ad44eda6520664a36f">SDL_ESM_setNError</a></div><div class="ttdeci">int32_t SDL_ESM_setNError(SDL_ESM_Inst instance)</div><div class="ttdoc">SDL ESM API to set the nError pin for the specified ESM instance.</div></div>
<div class="ttc" id="astructSDL__ESM__config_html_ad175456d8f1499780ab48da182d68412"><div class="ttname"><a href="structSDL__ESM__config.html#ad175456d8f1499780ab48da182d68412">SDL_ESM_config::esmErrorConfig</a></div><div class="ttdeci">SDL_ESM_ErrorConfig_t esmErrorConfig</div><div class="ttdef"><b>Definition:</b> esm/sdl_esm.h:199</div></div>
<div class="ttc" id="agroup__SDL__ESM__MODULE_html_ga9ce49362624d8bbb550a5a78198dff67"><div class="ttname"><a href="group__SDL__ESM__MODULE.html#ga9ce49362624d8bbb550a5a78198dff67">SDL_ESM_init</a></div><div class="ttdeci">int32_t SDL_ESM_init(SDL_ESM_Inst instance, const SDL_ESM_config *pConfig, SDL_ESM_applicationCallback applicationCallback, void *appArg)</div><div class="ttdoc">SDL ESM API to initialize an ESM instance. The API initializes the specified ESM instance with the pr...</div></div>
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
